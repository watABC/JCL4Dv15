//JCL_lst_Properties_save//20151220 yabe//リストボックスの列幅、ソート状態をファイルに保存C_TEXT($1;$lstName)$lstName:=$1C_TEXT($jclDirName;$dbDirName;$fileName;$folderPath;$filePath)$fileName:=$lstName+".txt"$folderPath:=System folder(User Preferences_User)$jclDirName:="4D_JCL"$filePath:=Jiro_file_MakeFilePath ($folderPath;$jclDirName)If (Test path name($filePath)#Is a folder)CREATE FOLDER($filePath)End if $dbDirName:=Structure file$filePath:=Jiro_file_MakeFilePath ($filePath;$dbDirName)If (Test path name($filePath)#Is a folder)CREATE FOLDER($filePath)End if C_TIME($FileRef)$filePath:=Jiro_file_MakeFilePath ($filePath;$fileName)//エラーコールON ERR CALL("Jiro_file_OnErrorCall")$FileRef:=Create document($filePath)If (OK=1)ARRAY TEXT($arrColNames;0)ARRAY TEXT($arrHeaderNames;0)ARRAY POINTER($arrColVars;0)ARRAY POINTER($arrHeaderVars;0)ARRAY BOOLEAN($arrColsVisible;0)ARRAY POINTER($arrStyles;0)C_LONGINT($i;$numOfObjects)LISTBOX GET ARRAYS(*;$lstName;$arrColNames;$arrHeaderNames;$arrColVars;$arrHeaderVars;$arrColsVisible;$arrStyles)$numOfObjects:=Size of array($arrColNames)For ($i;1;$numOfObjects)Jiro_file_WriteSJIS ($FileRef;$arrColNames{$i})Jiro_file_WriteTab ($FileRef)Jiro_file_WriteSJIS ($FileRef;String(LISTBOX Get column width(*;$arrColNames{$i})))Jiro_file_WriteCRLF ($FileRef)End for $numOfObjects:=Size of array($arrHeaderNames)For ($i;1;$numOfObjects)Jiro_file_WriteSJIS ($FileRef;$arrHeaderNames{$i})Jiro_file_WriteTab ($FileRef)Jiro_file_WriteSJIS ($FileRef;String($arrHeaderVars{$i}->))Jiro_file_WriteCRLF ($FileRef)End for //ファイルを閉じるCLOSE DOCUMENT($FileRef)End if //エラーコール終了ON ERR CALL("")