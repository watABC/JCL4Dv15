  //JCL_file_DataBaseName   //20151220 yabe  //4Dのデータベース名を取得C_LONGINT($type)$type:=Application typeC_TEXT($separator)$separator:=JCL_file_GetDirSeparator C_TEXT($dbFilePath)$dbFilePath:=""ARRAY TEXT($itemAry1;0)C_LONGINT($numOfItem1)ARRAY TEXT($itemAry2;0)C_LONGINT($i;$numOfItem2)C_TEXT($0;$dbName)Case of : ($type=4D Remote mode)$dbName:=Structure file: ($type=4D Volume desktop)$dbFilePath:=Application fileElse $dbFilePath:=Structure fileEnd case If ($dbFilePath#"")$numOfItem1:=JCL_str_Extract ($dbFilePath;$separator;->$itemAry1)$dbName:=$itemAry1{$numOfItem1}$numOfItem2:=JCL_str_Extract ($dbName;".";->$itemAry2)$dbName:=""For ($i;1;$numOfItem2-1)$dbName:=$dbName+$itemAry2{$i}+"."End for $dbName:=Substring($dbName;1;Length($dbName)-1)End if $0:=$dbName