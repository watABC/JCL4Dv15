//JCL_lst_Properties_load//20151220 yabe//リストボックスの列幅、ソート状態をファイルから読み込むC_TEXT($1;$lstName)$lstName:=$1C_TEXT($jclDirName;$dbDirName;$fileName;$folderPath;$filePath)$fileName:=$lstName+".txt"$folderPath:=System folder(User Preferences_User)$jclDirName:="4D_JCL"$dbDirName:=Structure file$filePath:=Jiro_file_MakeFilePath ($folderPath;$jclDirName)$filePath:=Jiro_file_MakeFilePath ($filePath;$dbDirName)$filePath:=Jiro_file_MakeFilePath ($filePath;$fileName)If (Test path name($filePath)=Is a document)ARRAY TEXT($arrColNames;0)ARRAY TEXT($arrHeaderNames;0)ARRAY POINTER($arrColVars;0)ARRAY POINTER($arrHeaderVars;0)ARRAY BOOLEAN($arrColsVisible;0)ARRAY POINTER($arrStyles;0)LISTBOX GET ARRAYS(*;$lstName;$arrColNames;$arrHeaderNames;$arrColVars;$arrHeaderVars;$arrColsVisible;$arrStyles)C_LONGINT($receive_ok)$open_dlg_ok:=0C_TEXT($fileText)//読み込んだファイルC_TEXT($rowDelimiter)$rowDelimiter:=Char(Carriage return)+Char(Line feed)C_TEXT($columnDelimiter)$columnDelimiter:=Char(Tab)C_LONGINT($i;$numOfLines;$numOfItems;$index)ARRAY TEXT($lineAry;0)ARRAY TEXT($itemAry;0)C_TIME($doc)$doc:=Open document($filePath)If (OK=1)$receive_ok:=Jiro_file_ReadSJIS ($doc;Char(NUL ASCII code);->$fileText)CLOSE DOCUMENT($doc)$numOfLines:=Jiro_str_Extract ($fileText;$rowDelimiter;->$lineAry)//列幅For ($i;1;$numOfLines)//タブで切り分ける$numOfItems:=Jiro_str_Extract ($lineAry{$i};$columnDelimiter;->$itemAry)If ($numOfItems>=2)$index:=Find in array($arrColNames;$itemAry{1})If ($index#-1)LISTBOX SET COLUMN WIDTH(*;$itemAry{1};Num($itemAry{2}))End if End if DELETE FROM ARRAY($itemAry;1;Size of array($itemAry))End for End if //ソートFor ($i;1;$numOfLines)//タブで切り分ける$numOfItems:=Jiro_str_Extract ($lineAry{$i};$columnDelimiter;->$itemAry)If ($numOfItems>=2)$index:=Find in array($arrHeaderNames;$itemAry{1})If ($index#-1)If ($itemAry{2}="1")LISTBOX SORT COLUMNS(*;$lstName;$index;>)End if If ($itemAry{2}="2")LISTBOX SORT COLUMNS(*;$lstName;$index;<)End if End if End if DELETE FROM ARRAY($itemAry;1;Size of array($itemAry))End for End if 